var alertFactory=function(a,b,c,d,e,f,g){var h=[],i=function(a){return angular.isObject(a)?a:{message:a}},j=function(a){var b=h.filter(function(b){return a!==b});h=b},k=function(a){return h.some(function(b){return a===b})},l=function(a){var d=b.defer();a=i(a);var f=e.open({windowClass:"ui-alert-modal",templateUrl:"components/ui-alert/template/alert.tpl",controller:"ui.alertCtrl",backdrop:"static",keyboard:!1,size:"sm",resolve:{data:function(){return{stateClass:a.state||l.STATE.INFO,message:a.message||"",resolveText:a.resolveText||"确定"}}}});return h.push(f),f.result.then(function(b){j(f),d.resolve(b),a.direct&&c.url(a.direct)},function(a){j(f),d.reject(a)}),d.promise};return l.STATE={SUCCESS:"success",ERROR:"danger",INFO:"info",WARNING:"warning",DANGER:"danger"},g.on("keydown",function(b){var c;13===b.which&&(c=f.getTop(),c&&k(c.key)&&(b.preventDefault(),a.$apply(function(){c.key.close()})))}),Object.keys(l.STATE).forEach(function(a){a=a.toLowerCase(),l[a]=function(b){return l({state:a,message:b})}}),l};alertFactory.$inject=["$rootScope","$q","$location","$sce","$modal","$modalStack","$document"],angular.module("components.ui.alert",[]).controller("ui.alertCtrl",function(a,b,c){a.data=c,a.ok=function(){b.close()}}).factory("uiAlert",alertFactory).factory("UIAlert",alertFactory);var confirmFactory=function(a,b,c,d,e,f,g){var h=[],i=function(a){return angular.isObject(a)?a:{message:a}},j=function(a){var b=h.filter(function(b){return a!==b});h=b},k=function(a){return h.some(function(b){return a===b})},l=function(a){var d=b.defer();a=i(a);var f=e.open({windowClass:"ui-confirm-modal",templateUrl:"components/ui-confirm/template/confirm.tpl",controller:"ui.confirmCtrl",backdrop:"static",keyboard:!0,size:"sm",resolve:{data:function(){return{stateClass:a.state||l.STATE.INFO,message:a.message||"",resolveText:a.resolveText||"确定",rejectText:a.rejectText||"取消"}}}});return h.push(f),f.result.then(function(b){j(f),d.resolve(b),a.direct&&c.url(a.direct)},function(a){j(f),d.reject(a)}),d.promise};return l.STATE={SUCCESS:"success",ERROR:"danger",INFO:"info",WARNING:"warning",DANGER:"danger"},g.on("keydown",function(b){var c;13===b.which&&(c=f.getTop(),c&&k(c.key)&&(b.preventDefault(),a.$apply(function(){c.key.close()})))}),Object.keys(l.STATE).forEach(function(a){a=a.toLowerCase(),l[a]=function(b){return l({state:a,message:b})}}),l};confirmFactory.$inject=["$rootScope","$q","$location","$sce","$modal","$modalStack","$document"],angular.module("components.ui.confirm",[]).controller("ui.confirmCtrl",function(a,b,c){a.data=c,a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}}).factory("uiConfirm",confirmFactory).factory("UIConfirm",confirmFactory),angular.module("components.ui.datepicker",[]).constant("UIDatePickerConfig",{templateUrl:"components/ui-datepicker/template/datepicker.tpl",view:"date",views:["year","month","date","hours","minutes"],format:"yyyy-MM-dd HH:mm",closeOnDateSelection:!0,step:5,appendToBody:!1}).filter("UITime",function(){function a(a){return("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)}return function(b){return b instanceof Date||(b=new Date(b),!isNaN(b.getTime()))?a(b):void 0}}).factory("UIDatePickerUtils",function(){var a=function(a,b,c,d,e){return new Date(0|a,0|b,0|c,0|d,0|e)};return{getVisibleMinutes:function(b,c){b=new Date(b||new Date);var d,e,f=b.getFullYear(),g=b.getMonth(),h=b.getDate(),i=b.getHours(),j=[];for(d=0;60>d;d+=c)e=a(f,g,h,i,d),j.push(e);return j},getVisibleWeeks:function(a){a=new Date(a||new Date);var b=a.getMonth(),c=a.getYear();a.setDate(1),0===a.getDay()?a.setDate(-5):a.setDate(a.getDate()-(a.getDay()-1)),1===a.getDate()&&a.setDate(-6);for(var d,e=[];e.length<6&&!(a.getYear()===c&&a.getMonth()>b);)d=this.getDaysOfWeek(a),e.push(d),a.setDate(a.getDate()+7);return e},getVisibleYears:function(b){b=new Date(b||new Date),b.setFullYear(b.getFullYear()-b.getFullYear()%10);for(var c,d=b.getFullYear(),e=[],f=0;12>f;f++)c=a(d),e.push(c),d++;return e},getDaysOfWeek:function(b){b=new Date(b||new Date),b.setDate(b.getDate()-(b.getDay()-1));for(var c,d=b.getFullYear(),e=b.getMonth(),f=b.getDate(),g=[],h=0;7>h;h++)c=a(d,e,f),g.push(c),f++;return g},getVisibleMonths:function(b){b=new Date(b||new Date);for(var c,d=b.getFullYear(),e=[],f=0;12>f;f++)c=a(d,f,1),e.push(c);return e},getVisibleHours:function(b){b=new Date(b||new Date);var c,d,e=b.getFullYear(),f=b.getMonth(),g=b.getDate(),h=[];for(c=0;24>c;c++)d=a(e,f,g,c),h.push(d);return h},isAfter:function(a,b){return a.getTime()>=b.getTime()},isBefore:function(a,b){return a.getTime()<=b.getTime()},isSameYear:function(a,b){return a.getFullYear()===b.getFullYear()},isSameMonth:function(a,b){return this.isSameYear(a,b)&&a.getMonth()===b.getMonth()},isSameDay:function(a,b){return this.isSameMonth(a,b)&&a.getDate()===b.getDate()},isSameHour:function(a,b){return this.isSameDay(a,b)&&a.getHours()===b.getHours()},isSameMinutes:function(a,b){return this.isSameHour(a,b)&&a.getMinutes()===b.getMinutes()},isValidDate:function(a){return a&&!(a.getTime&&a.getTime()!==a.getTime())},parseDate:function(a,b){if(angular.isNumber(a)&&(a=new Date(a)),b=b||NaN,a){if(angular.isDate(a))return angular.copy(a);if(angular.isString(a)){var c=Date.parse(a);return isNaN(c)?b:new Date(a)}return b}return b}}}).directive("uiDatePicker",["UIDatePickerConfig","UIDatePickerUtils","$filter","$log",function(a,b,c,d){c("date");return{restrict:"A",transclude:!0,require:"?^ngModel",templateUrl:a.templateUrl,scope:{after:"=?",minDate:"=?",before:"=?",maxDate:"=?",dateDisabled:"&"},link:function(c,e,f,g){function h(a){return d.info("parser-picker",a),b.parseDate(a)}function i(){var a=c.view;l&&!m&&(c.date=new Date(l));var d=c.date;switch(a){case"year":c.years=b.getVisibleYears(d);break;case"month":c.months=b.getVisibleMonths(d);break;case"date":c.weekdays=c.weekdays||b.getDaysOfWeek(),c.weeks=b.getVisibleWeeks(d);break;case"hours":c.hours=b.getVisibleHours(d);break;case"minutes":c.minutes=b.getVisibleMinutes(d,k)}}function j(){return"date"!==c.view?c.view:c.date?c.date.getMonth():null}var k=parseInt(f.step||a.step,10),l=new Date,m=!1,n=new Date,o=(f.format||a.format,a.views);c.date=new Date,c.view=f.view||a.view,o=o.slice(o.indexOf(f.maxView||o[0]),o.indexOf(f.minView||o[o.length-1])+1),(1===o.length||-1===o.indexOf(c.view))&&(c.view=o[0]),g&&(g.$render=function(){d.info("render-picker",g.$modelValue),l=b.parseDate(g.$modelValue,new Date),c.date=angular.copy(l)},g.$parsers.unshift(h),g.$viewChangeListeners.push(function(){d.info("viewChangeListeners-picker",g.$modelValue)})),c.setView=function(a){-1!==o.indexOf(a)&&setTimeout(function(){c.view=a,c.$apply()},100)},c.setLastView=function(a){var b=o.indexOf(c.view),d=b>0?o[b-1]:null;d&&(c.view=d)},c.setDate=function(a){if(!f.disabled){c.date=a;var b=o[o.indexOf(c.view)+1];switch(c.view){case"minutes":l.setMinutes(a.getMinutes());case"hours":l.setHours(a.getHours());case"date":l.setDate(a.getDate());case"month":l.setMonth(a.getMonth());case"year":l.setFullYear(a.getFullYear())}b?c.setView(b):(g&&(g.$setViewValue(angular.copy(l)),g.$render()),c.$emit("setDate",l,c.view)),m=!1}},c.$watch(j,i),c.next=function(a){var b=c.date;switch(a=a||1,c.view){case"year":case"month":b.setFullYear(b.getFullYear()+a);break;case"date":b.setMonth(b.getMonth()+a);break;case"hours":case"minutes":b.setHours(b.getHours()+a)}m=!0,i()},c.prev=function(a){return c.next(-a||-1)},c.isDisabled=function(a){return"date"==c.view?c.minDate&&a<c.minDate||c.maxDate&&a>c.maxDate||f.dateDisabled&&c.dateDisabled({date:a,view:c.view}):f.dateDisabled&&c.dateDisabled({date:a,view:c.view})},c.isAfter=function(a){return c.after&&b.isAfter(a,c.after)},c.isBefore=function(a){return c.before&&b.isBefore(a,c.before)},c.isSameMonth=function(a){return b.isSameMonth(l,a)},c.isSameYear=function(a){return b.isSameYear(l,a)},c.isSameDay=function(a){return b.isSameDay(l,a)},c.isSameHour=function(a){return b.isSameHour(l,a)},c.isSameMinutes=function(a){return b.isSameMinutes(l,a)},c.isNow=function(a){var b=!0;switch(c.view){case"minutes":b&=~~(a.getMinutes()/k)===~~(n.getMinutes()/k);case"hours":b&=a.getHours()===n.getHours();case"date":b&=a.getDate()===n.getDate();case"month":b&=a.getMonth()===n.getMonth();case"year":b&=a.getFullYear()===n.getFullYear()}return b}}}}]).directive("uiDateRange",function(){return{templateUrl:"components/ui-datepicker/template/daterange.tpl",scope:{start:"=",end:"="},link:function(a,b,c){a.start=new Date(a.start||new Date),a.end=new Date(a.end||new Date),c.$observe("disabled",function(b){a.disableDatePickers=!!b}),a.$watch("start.getTime()",function(b){b&&a.end&&b>a.end.getTime()&&(a.end=new Date(b))}),a.$watch("end.getTime()",function(b){b&&a.start&&b<a.start.getTime()&&(a.start=new Date(b))})}}}).directive("uiDateTimeAppend",function(){return{link:function(a,b){b.bind("click",function(){b.find("input")[0].focus()})}}}).directive("uiDateTime",["$compile","$document","$filter","UIDatePickerConfig","UIDatePickerUtils","$log",function(a,b,c,d,e,f){var g=b.find("body"),h=c("date");return{restrict:"A",require:"ngModel",scope:{dateDisabled:"&"},link:function(c,i,j,k){function l(a){var a=e.parseDate(a);return f.info("formatter-input",a,r,h(a,r)),e.isValidDate(a)&&(c.picked=a),a?h(a,r):""}function m(a){f.info("parser-input",a,e.parseDate(a));var b=e.parseDate(a);return e.isValidDate(b)&&(c.picked=b),b}function n(a,b){f.info("validator-input",a,b);var c=a||b;return c?e.isValidDate(e.parseDate(b)):!0}function o(a){a.target!=i[0]&&u&&0==w&&p()}function p(){u&&(u.remove(),u=null),v&&(v.remove(),v=null)}function q(){if(!u){if(u=a(y)(c),c.$digest(),t){var b=angular.extend(i.offset(),{height:i[0].offsetHeight});u.css({top:b.top+b.height,left:b.left}),g.append(u)}else{v=angular.element("<div ui-date-picker-wrapper></div>"),i[0].parentElement.insertBefore(v[0],i[0]);var b=angular.extend(i.position(),{height:i[0].offsetHeight}),d=v.position();v.append(u),u.css({left:b.left-d.left,top:b.top+b.height-d.top})}u.on("mousedown",function(a){w=!0,setTimeout(function(){w=!1},0)})}}c.picked=NaN,c.watchData={};var r=j.format||d.format,s=(d.views,angular.isDefined(j.closeOnDateSelection)?c.$parent.$eval(j.closeOnDateSelection):d.closeOnDateSelection),t=angular.isDefined(j.appendToBody)?c.$parent.$eval(j.appendToBody):d.appendToBody,u=null,v=null,w=!1,x=function(){function a(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}return function(){var b=angular.element('<div ui-date-picker class="ui-date-picker-date-time"><div ng-transclude></div></div>'),d={"ng-model":"picked","ng-change":"dateSelection(date)"};["minView","maxView","view","step"].forEach(function(b){j[b]&&(d[a(b)]=c.$parent.$eval(j[b])||j[b])}),["minDate","maxDate"].forEach(function(b){j[b]&&(d[a(b)]="watchData."+b)}),j.dateDisabled&&(d["date-disabled"]="dateDisabled({ date: date, view: view })"),b.attr(d);var e=b[0];return b.remove(),e}}(),y=x();if(k.$$parserName="date",k.$validators.date=n,k.$formatters.push(l),k.$parsers.unshift(m),k.$viewChangeListeners.push(function(){f.info("viewChangeListeners-input",k.$modelValue)}),j.minDate){var z;k.$validators.min=function(a){return!z||!e.isValidDate(z)||!e.isValidDate(a)||a>=z},c.$parent.$watch(j.minDate,function(a){z=e.parseDate(a),e.isValidDate(z)&&(z.setHours(0,0,0,0),k.$validate(),c.watchData.minDate=z)})}if(j.maxDate){var A;k.$validators.max=function(a){return!A||!e.isValidDate(A)||!e.isValidDate(a)||A>=a},c.$parent.$watch(j.maxDate,function(a){A=e.parseDate(a),e.isValidDate(z)&&(A.setHours(23,59,59,0),k.$validate(),c.watchData.maxDate=A)})}i.on("click",q),b.on("mousedown",o),c.$on("setDate",function(a,b,c){var b=b?h(b,r):"";f.info("setDate",b),k.$setViewValue(b),k.$render(),s&&(p(),i[0].focus())}),c.$on("$destroy",function(){i.off("click",q),b.off("mousedown",o),p()})}}}]),angular.module("components.ui.menu",[]).factory("UIMenu",function(a,b,c){var d=[],e=[],f={},g=function(){var a={};return{set:function(b,c){a[b]&&angular.isArray(a[b])?a[b].push(c):a[b]=[c]},get:function(b){return a[b]||null}}}(),h=function(){var a=[];return{isUnfold:function(b){return b&&b.id&&a.indexOf(b.id)>-1},unfold:function(b){angular.isArray(b)||(b=[b]);var c,d,e=[];b.forEach(function(a){for(-1==e.indexOf(a.id)&&e.push(a.id),d=a.parentId;d&&(c=f[d]);)-1==e.indexOf(c.id)&&e.push(c.id),d=c.parentId}),a=e},fold:function(a){angular.isArray(a)||(a=[a]);var b,c=[];a.forEach(function(a){a.parentId&&(b=f[a.parentId])&&c.push(b)}),h.unfold(c)},update:function(){if(b.path())for(var a,c,d=b.path().split("/");d.length>0;){if(a=d.join("/"),c=g.get("#"+a),c&&c.length>0){h.unfold(c);break}d.pop()}},init:function(){h.clear(),h.update()},clear:function(){a=[]}}}(),i=function(a){this.node=a,this.id=a.id,this.url=a.url,this.title=a.title,a.parentId&&(this.parentId=a.parentId)};i.prototype={isParent:function(){return this.node&&this.node.children&&this.node.children.length>0},isChild:function(){return this.node&&!this.isParent()},getChildren:function(){return this.node.children||null},isUnfold:function(){return h.isUnfold(this.node)},toggleUnfold:function(){h.isUnfold(this.node)?h.fold(this.node):h.unfold(this.node)}};var j=function(a,b){var c={},d=a.map(function(a){if(a=angular.copy(a),b&&(a.parentId=b),a.children&&a.children.length>0){var d=j(a.children,a.id);a.children=d[0],angular.extend(c,d[1])}a.url&&-1==a.url.indexOf("http://")&&-1==a.url.indexOf("https://")&&("/"!=a.url[0]&&(a.url="/"+a.url),a.url="#"+a.url);var e=new i(a);return c[a.id]=e,g.set(a.url,e),e});return[d,c]},k={init:function(a){if(!a)return[];var b=angular.copy(a);if(!angular.equals(b,d)){d=b;var c=j(d);e=c[0],f=c[1],h.init()}return e},getAll:function(){return e},getById:function(a){return f[a]||null}};return c.$on("$locationChangeSuccess",h.update),k}).directive("uiMenu",["$compile","UIMenu",function(a,b){return{restrict:"AE",templateUrl:"components/ui-menu/template/menu.tpl",replace:!0,scope:{rootData:"=",childrenData:"="},compile:function(c,d,e){var f,g=c.contents().remove();return function(c,d,h){f||(f=a(g,e)),c.$watch(function(){return c.rootData||null},function(a){null!=a&&(c.uiMenuNodes=b.init(a),f(c,function(a,b){d.empty().append(a)}))},!0),c.$watch(function(){return c.childrenData||null},function(a){null!=a&&(c.uiMenuNodes=a,f(c,function(a,b){d.empty().append(a)}))},!0)}}}}]),angular.module("ui.validate",[]).directive("uiValidate",["$$uiValidateApplyWatch",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var f,g=b.$eval(d.uiValidate);g&&(angular.isString(g)&&(g={validator:g}),angular.forEach(g,function(a,c){f=function(d,f){var g=b.$eval(a,{$value:d,$modelValue:d,$viewValue:f,$name:e.$name});return angular.isObject(g)&&angular.isFunction(g.then)?(g.then(function(){e.$setValidity(c,!0)},function(){e.$setValidity(c,!1)}),e.$asyncValidators[c]=function(){return g},!0):g},e.$validators[c]=f}),d.uiValidateWatch&&a(b,e,b.$eval(d.uiValidateWatch)))}}}]).directive("uiValidateAsync",["$$uiValidateApplyWatch","$timeout","$q",function(a,b,c){return{restrict:"A",require:"ngModel",link:function(b,d,e,f){var g,h=b.$eval(e.uiValidateAsync);h&&(angular.isString(h)&&(h={validatorAsync:h}),angular.forEach(h,function(a,d){g=function(d,e){var g=b.$eval(a,{$value:d,$modelValue:d,$viewValue:e,$name:f.$name});return angular.isObject(g)&&angular.isFunction(g.then)?g:c(function(a,b){setTimeout(function(){g?a():b()},0)})},f.$asyncValidators[d]=g}),e.uiValidateWatch&&a(b,f,b.$eval(e.uiValidateWatch)))}}}]).service("$$uiValidateApplyWatch",function(){return function(a,b,c){angular.isString(c)?a.$watch(c,function(){b.$validate()}):angular.isArray(c)?angular.forEach(c,function(c){a.$watch(c,function(){b.$validate()})}):angular.isObject(c)&&angular.forEach(c,function(c){angular.isString(c)&&a.$watch(c,function(){b.$validate()}),angular.isArray(c)&&angular.forEach(c,function(c){a.$watch(c,function(){b.$validate()})})})}}),angular.module("components",["components.ui.confirm","components.ui.menu","components.ui.datepicker","components.ui.alert","ui.validate"]),console.log("load components .. ");